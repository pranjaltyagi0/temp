SELECT
    e.employee_id,
    e.first_name,
    e.last_name,
    j1.job_title AS first_job,
    j2.job_title AS promoted_to
FROM employees e
JOIN (
    -- First job for each employee using correlated subquery
    SELECT jh.employee_id, jh.job_id
    FROM job_history jh
    WHERE jh.start_date = (
        SELECT MIN(start_date)
        FROM job_history
        WHERE employee_id = jh.employee_id
    )
) first_jobs ON e.employee_id = first_jobs.employee_id
LEFT JOIN (
    -- Promoted job using correlated subquery
    SELECT jh.employee_id, jh.job_id
    FROM job_history jh
    WHERE jh.start_date = (
        SELECT MIN(start_date)
        FROM job_history
        WHERE employee_id = jh.employee_id
          AND start_date > (
              SELECT MIN(start_date)
              FROM job_history
              WHERE employee_id = jh.employee_id
          )
    )
) promoted_jobs ON e.employee_id = promoted_jobs.employee_id
JOIN jobs j1 ON first_jobs.job_id = j1.job_id
LEFT JOIN jobs j2 ON promoted_jobs.job_id = j2.job_id;
